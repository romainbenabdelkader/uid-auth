{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "title": "UID_AUTH Manifest Schema",
  "description": "Schéma du manifest UID_AUTH pour la preuve d'origine, l'intégrité, et les signaux IA / TDM conformes AI Act.",
  "type": "object",

  "properties": {

    "uid_auth": {
      "type": "string",
      "pattern": "^[A-Z]{2}-[0-9]{4}-AUTH-[0-9]{6}$",
      "description": "Identifiant souverain UID_AUTH (ex: FR-2025-AUTH-000001)."
    },

    "name": {
      "type": "string",
      "description": "Nom de l’œuvre (optionnel mais recommandé)."
    },

    "creator": {
      "type": "string",
      "description": "Nom ou identifiant public du créateur de l’œuvre."
    },

    "origin": {
      "type": "string",
      "enum": ["human", "ai", "hybrid"],
      "description": "Déclaration d’origine de l’œuvre (obligation IA Act : transparency signal)."
    },

    "issued_at": {
      "type": "string",
      "format": "date-time",
      "description": "Horodatage ISO 8601 indiquant la date de génération de l’UID_AUTH."
    },

    "issuer": {
      "type": "object",
      "description": "Autorité ayant délivré l’UID_AUTH.",
      "properties": {
        "name": {
          "type": "string",
          "description": "Nom de l’autorité (ex : AUTHENTICA)."
        },
        "type": {
          "type": "string",
          "enum": ["IdentityAuthority", "CollectingSociety", "Label", "TrustedEntity"],
          "description": "Typologie de l’autorité émettrice."
        }
      },
      "required": ["name", "type"]
    },

    "rights": {
      "type": "object",
      "description": "Bloc décrivant les droits et restrictions liés à l’œuvre, notamment IA / TDM.",
      "properties": {

        "ai_training": {
          "type": "string",
          "enum": ["prohibited", "allowed", "restricted", "conditional"],
          "description": "Statut de l’œuvre pour l’entraînement IA (AI Act transparency signal)."
        },

        "training_conditions": {
          "type": "string",
          "format": "uri",
          "description": "URL vers les conditions détaillées (opt-in, restrictions, contrats)."
        },

        "tdm_opt_out": {
          "type": "boolean",
          "description": "Activation du droit d’opposition au Text and Data Mining (Directive UE 2019/790)."
        },

        "jurisdiction": {
          "type": "string",
          "description": "Juridiction applicable (ex : 'EU', 'FR', 'US')."
        }
      },
      "required": ["ai_training"]
    },

    "hash": {
      "type": "object",
      "description": "Preuve d’intégrité cryptographique.",
      "properties": {
        "algorithm": {
          "type": "string",
          "enum": ["sha256"],
          "description": "Algorithme utilisé pour le hash (par défaut SHA-256)."
        },
        "value": {
          "type": "string",
          "description": "Valeur hexadécimale du hash SHA-256."
        }
      },
      "required": ["algorithm", "value"]
    }
  },

  "required": [
    "uid_auth",
    "origin",
    "issued_at",
    "issuer",
    "rights",
    "hash"
  ]
}
